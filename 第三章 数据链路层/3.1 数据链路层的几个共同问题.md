物理层没解决的问题：

- **传输错误问题**：发送端发送比特1，而接收端收到比特0，接收端无法知道接收的是否正确
- **接收方选择问题**：多个设备连接，谁发送谁接受
- **传输结束问题**：如何知道一组数据即将到来，何时结束

### 3.1.1 数据链路和帧

**链路**：从一个节点到相邻节点的一段物理线路

**数据链路**：联络+实现协议的硬件和软件or网络适配器

**帧**：点对点信道的通信链路层的协议数据单元

### 3.1.2 三个基本问题

1. 封装成帧

- 在一段数据的前后分别添加首部和尾部，然后就构成了一个帧，确定帧的界限
- 首部和尾部的一个重要作用就是进行帧定界

2. 透明传输

- 解决方法：字节填充或字符填充
- 发送端的数据链路层在数据中出现控制字符“SOH”或“EOT”前插入一个**转义字符“ESC”**
- 若转义字符也出现在数据当中，则在转义字符前插入一个转义字符，接收到连续的转义字符时，删除前面的一个

3. 差错检测

- 循环冗余检验（Cyclic Redundancy Check,CRC）
	- 在发送端，先把数据划分成组，假定每组k个比特
	- 冗余码的计算
		- **原理**：通过模2除法（异或运算）生成冗余位，广泛应用于网络通信和存储系统。
		- **计算步骤**：
			- **约定生成多项式**（如CRC-32的`G(x) = x³² + x²⁶ + x²³ + x²² + x¹⁶ + x¹² + x¹¹ + x¹⁰ + x⁸ + x⁷ + x⁵ + x⁴ + x² + x + 1`）。
			- **数据左移**：在原始数据后补`r`个0（`r`是生成多项式的最高次幂）。
			- **模2除法**：用生成多项式对应的二进制数除扩展后的数据，余数即为冗余码（CRC码）。
			- **附加冗余码**：将余数替换到数据末尾的0位置。
		- **示例**：
			- 数据：`1101011011`，生成多项式：`10011`（x⁴ + x + 1）
			- 步骤：
				- 数据左移4位：`11010110110000`
				- 模2除法求余数（过程略），得到冗余码：`1110`
				- 传输数据：`11010110111110`



- 帧检验序列（Frame Check Sequence, FCS）

	- **定义与本质**

		表格

		复制

		| 项目 | CRC                                     | FCS                                                          |
		| :--- | :-------------------------------------- | :----------------------------------------------------------- |
		| 全称 | Cyclic Redundancy Check（循环冗余校验） | Frame Check Sequence（帧检验序列）                           |
		| 本质 | 一种**错误检测的算法或方法**            | 一个**附加在数据帧尾部的字段或值**（通常是CRC计算得出的冗余码） |

	- **功能与作用**

		- **CRC**：
			- 是一种**数学算法**，通过生成多项式对数据进行除法运算，生成校验码。
			- 用于**检测数据传输过程中是否出现比特错误**（如0变1或1变0）。
			- 本身是一种**方法**，不依赖于具体帧结构。
		- **FCS**：
			- 是**数据链路层帧格式中的一个字段**（通常为4字节），用于存储校验码。
			- 提供**错误检测机制**，接收方通过重新计算校验码并与FCS字段比较，判断帧是否出错。
			- 是**CRC算法的一种应用场景**，但理论上也可以通过其他校验方法生成。

	- **关系与区别**

		- **关系**：
			- FCS**通常由CRC算法计算得出**，是CRC校验码在帧中的具体体现。
			- 例如，以太网帧的FCS字段就是使用CRC-32算法生成的32位校验码。
		- **区别**：
			- CRC是**算法**，FCS是**结果或字段**。
			- CRC不限于网络通信，也用于存储、压缩等领域；FCS**专用于数据帧的完整性校验**。
			- CRC只提供**检错能力**，FCS字段的存在使得接收方可以**快速判断帧是否出错并丢弃错误帧**。

	- **工作流程举例**（以太网帧）

		- 发送端：
			- 对帧头+数据部分使用CRC算法（如CRC-32）计算冗余码。
			- 将计算结果作为FCS字段附加在帧尾。
		- 接收端：
			- 对接收到的帧（除FCS外）重新计算CRC。
			- 将计算结果与接收到的FCS比较：
				- 若一致，认为帧无错，接受。
				- 若不一致，认为帧出错，丢弃。

	- **总结**

		- **CRC是“方法”，FCS是“结果”**。
		- **FCS是CRC在数据帧中的具体应用**，但FCS也可以通过其他校验算法生成。
		- 在以太网等协议中，**FCS字段就是CRC校验码**，用于确保帧在传输过程中的完整性。