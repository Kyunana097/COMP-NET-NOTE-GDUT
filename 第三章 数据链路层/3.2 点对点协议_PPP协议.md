### 3.2.1 PPP协议的特点

1. PPP协议应满足的需求

2. PPP协议不需要的功能

- 纠错
- 流量
- 序号
- 多点线路
- 半双工或单工链路

### 3.2.2 PPP协议的帧格式

1. 各字段的意义
	1. Flag（标志字段）
		固定 0x7E（01111110），标识一帧的开始与结束。采用“比特填充”（发送端在连续 5 个 1 后自动插入 1 个 0）或“字符填充”（异步链路时转义）保证数据透明传输。
	2. Address（地址字段）
		固定 0xFF（11111111）。PPP 是点对点链路，不需要地址寻址，保留该字段仅为与 HDLC 兼容。
	3. Control（控制字段）    
		固定 0x03（00000011），表示“无编号帧”（UI），即没有序号、确认和流量控制，提供无连接不可靠服务。
	4. Protocol（协议字段）
		16 bit，指明 Data 字段承载的上层协议或协商子协议：
		1. 0x0021  IPv4 数据报
		2. 0x0057  IPv6 数据报
		3. 0x8021  IPCP（IP Control Protocol）
		4. 0xC021  LCP（Link Control Protocol）
		5. 0xC023  PAP
		6. 0xC223  CHAP
			等等。
	5. Data（信息字段）
		用户数据或协议协商报文。默认最大长度 1500 B（MRU），可在 LCP 阶段协商更大或更小值。不足 MRU 时无需填充。
	6. FCS（Frame Check Sequence）
		缺省 16 bit CRC（CRC-CCITT，生成多项式 x¹⁶+x¹²+x⁵+1）；LCP 可协商 32 bit CRC（CRC-32）。检验范围从 Address 到 Data 的最后一个字节。接收端计算出错则丢弃该帧，不反馈重传。
	7. 结束 Flag
		与起始 Flag 相同，也为 0x7E。两帧可以共用同一个 Flag（即前一帧的结束 Flag 同时作为下一帧的开始 Flag）。

2. 字节填充

- 一、发送端处理规则

	1. 帧首尾各插一个 Flag：0x7E。
		1. 对 Address、Control、Protocol、Data、FCS 各字节逐一扫描：
			- 若字节 == 0x7E → 替换成两字节序列 **0x7D 0x5E**
			- 若字节 == 0x7D → 替换成两字节序列 **0x7D 0x5D**
			- 若字节值 < 0x20（32）且该链路“允许转义控制字符”(ACCM)掩码对应位为1，也转义：
				0x7D + (原字节 XOR 0x20)
				默认 ACCM 为 0xFFFFFFFF，即所有 0x00–0x1F 全部转义；LCP 可协商改变 ACCM。

	2. 把转义后的字节流发出；FCS 计算**在转义之前**完成。

------

- 二、接收端恢复算法

	1. 收到字节流后，遇到 0x7E 即认为是帧边界。
		1. 扫描帧内字节：
			- 若当前字节 == 0x7D → 丢弃 0x7D，把下一字节 XOR 0x20 后作为真实数据；
			- 否则直接作为真实数据。

	2. 把还原后的完整帧（含 Addr/Ctrl/Protocol/Data/FCS）交给 FCS 校验；
		校验失败则丢弃，成功则按 Protocol 字段上交网络层。

3. 零比特填充：出现5个连续1时，在后面加一个0

### 3.2.3 PPP协议的工作状态

